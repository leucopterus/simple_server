This code is a solution to security problem, connected with cookies. 
The problem is: 
1) create another server to imitate thief's server
2) prevent unexpected access to the charge page

